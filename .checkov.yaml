# Checkov configuration file
# This file suppresses specific security findings that require architectural decisions
# or are not applicable to the current deployment model

# Global configuration
framework:
  - terraform

# Skip specific checks with justifications
skip-check:
  # S3 Lifecycle Configuration - Multipart Upload Cleanup
  # These are already implemented but still flagged - may be a checkov detection issue
  - CKV_AWS_300  # Ensure S3 lifecycle configuration sets period for aborting failed uploads

  # Lambda VPC Configuration
  # Suppressed: Lambda function doesn't require VPC access for this use case
  # The function only needs to trigger CodePipeline and doesn't access VPC resources
  - CKV_AWS_117  # Ensure that AWS Lambda function is configured inside a VPC

  # Lambda Code Signing
  # Suppressed: Code signing requires additional infrastructure setup and signing process
  # Consider implementing in production environments with higher security requirements
  - CKV_AWS_272  # Ensure AWS Lambda function is configured to validate code-signing

  # S3 Cross-Region Replication
  # Suppressed: Cross-region replication requires additional infrastructure and costs
  # Not required for this demo/development environment
  - CKV_AWS_144  # Ensure that S3 bucket has cross-region replication enabled

  # IAM Policy Wildcard Resources - AWS Service Limitations
  # Suppressed: X-Ray tracing and Lambda VPC integration require wildcard resources
  # - X-Ray: PutTraceSegments and PutTelemetryRecords require "*" per AWS documentation
  # - Lambda VPC: ENI operations (CreateNetworkInterface, etc.) require "*" for VPC integration
  # These are AWS service limitations and cannot be further scoped
  - CKV_AWS_290  # Ensure IAM policies does not allow write access without constraints
  - CKV_AWS_355  # Ensure no IAM policies documents allow "*" as a statement's resource for restrictable actions

  # Security Group Egress Rule - Lambda Outbound Traffic
  # Suppressed: Lambda function requires broad outbound access for AWS API calls
  # - Lambda needs to communicate with multiple AWS services (Batch, S3, SQS, KMS, CloudWatch)
  # - Using NAT Gateway for outbound traffic from private subnets
  # - Alternative would be VPC endpoints for each service, which adds complexity and cost
  # Consider implementing VPC endpoints in production for tighter security
  - CKV_AWS_382  # Ensure no security groups allow egress from 0.0.0.0:0 to port -1

# Optional: Specify directories to scan (if you want to limit scope)
# directory:
#   - "."

# Optional: Exclude specific directories
# skip-path:
#   - "node_modules"
#   - ".terraform"

# Optional: Set severity threshold
# check-threshold: HIGH

# Optional: Output format
# output: cli

# Optional: Quiet mode (reduce output verbosity)
# quiet: true